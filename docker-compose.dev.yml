# Docker Compose para desarrollo
version: '3.8'

services:
  mysql:
    image: mysql:8.0
    container_name: eltmko-mysql-dev
    environment:
      MYSQL_ROOT_PASSWORD: rootpassword
      MYSQL_DATABASE: elt_data
      MYSQL_USER: eltuser
      MYSQL_PASSWORD: eltpassword
    ports:
      - "3306:3306"
    volumes:
      - mysql_data_dev:/var/lib/mysql
      - ./init-db.sql:/docker-entrypoint-initdb.d/init-db.sql
    networks:
      - elt-network

  elt-api:
    build:
      context: .
      dockerfile: Dockerfile.dev
    container_name: eltmko-api-dev
    environment:
      MYSQL_HOST: mysql
      MYSQL_PORT: 3306
      MYSQL_USER: eltuser
      MYSQL_PASSWORD: eltpassword
      MYSQL_DATABASE: elt_data
      FACEBOOK_APP_ID: ${FACEBOOK_APP_ID}
      FACEBOOK_APP_SECRET: ${FACEBOOK_APP_SECRET}
      FACEBOOK_ACCESS_TOKEN: ${FACEBOOK_ACCESS_TOKEN}
      FACEBOOK_AD_ACCOUNT_ID: ${FACEBOOK_AD_ACCOUNT_ID}
      API_HOST: 0.0.0.0
      API_PORT: 5000
      FLASK_ENV: development
      FLASK_DEBUG: 1
    ports:
      - "5000:5000"
    volumes:
      - .:/app  # Monta todo el c√≥digo para hot-reload
    depends_on:
      - mysql
    networks:
      - elt-network
    command: python api.py

networks:
  elt-network:
    driver: bridge

volumes:
  mysql_data_dev:
    driver: local
